{
  "AWSTemplateFormatVersion": "2010-09-09",
  "Description": "RX Elasticache Redis Cluster",
  "Parameters": {
    "VpcId": {
      "Type": "String",
      "Description": "Supplied by drone-cloudformation-deploy plugin"
    },
    "SecurityGroup1": {
      "Type": "String",
      "Description": "Supplied by drone-cloudformation-deploy plugin"
    },
    "SubnetId01": {
      "Type": "String",
      "Description": "Supplied by drone-cloudformation-deploy plugin"
    },
    "SubnetId02": {
      "Type": "String",
      "Description": "Supplied by drone-cloudformation-deploy plugin"
    }
  },
  "Resources": {
    "RxCacheCluster": {
      "Type": "AWS::ElastiCache::CacheCluster",
      "Properties": {
        "VpcSecurityGroupIds": [
          {
            "Fn::Sub": "${SecurityGroup1}"
          }
        ],
        "EngineVersion": "3.2.4",
        "AZMode": "single-az",
        "CacheNodeType": "cache.t2.micro",
        "Engine": "redis",
        "ClusterName": "Rx-Cluster",
        "AutoMinorVersionUpgrade": false,
        "NumCacheNodes": 1,
        "CacheSubnetGroupName": {
          "Ref": "RxCacheSubnetGroup"
        }
      },
      "DeletionPolicy": "Delete"
    },
    "RxCacheSubnetGroup": {
      "Type": "AWS::ElastiCache::SubnetGroup",
      "Properties": {
        "SubnetIds": [
          {
            "Fn::Sub": "${SubnetId02}"
          },
          {
            "Fn::Sub": "${SubnetId01}"
          }
        ],
        "Description": "Subnet group for Elasticache"
      },
      "DeletionPolicy": "Delete"
    }
  }
}